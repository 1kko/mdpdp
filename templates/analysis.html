<!DOCTYPE html>

<meta charset = "utf-8">
<head>
	<title>MDPDP</title>
	<!-- Generated from http://realfavicongenerator.net/ -->
	<link rel="apple-touch-icon" sizes="57x57" href="/static/images/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/static/images/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/static/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/static/images/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/static/images/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/static/images/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/static/images/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/static/images/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/static/images/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/static/images/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/static/images/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/static/images/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/static/images/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/static/images/manifest.json">
	<link rel="shortcut icon" href="/static/images/favicon.ico">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="images/mstile-144x144.png">
	<meta name="msapplication-config" content="images/browserconfig.xml">
	<meta name="theme-color" content="#ffffff">

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />


	<!-- CDN Bootstrap CSS and JS from CDN -->
	<!-- <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> -->


	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap-slate.min.css">
	<!-- http://axicon.axisj.com/ -->
	<link rel="stylesheet" type="text/css" href="/static/axicon/axicon.min.css">
	<link rel="stylesheet" type="text/css" href="/static/js/jstree/themes/proton/style.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap-select.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap-switch.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/bootstrap-table.min.css">
	<link rel="stylesheet" type="text/css" href="/static/css/colorbox.css">
	<link rel="stylesheet" type="text/css" href="/static/css/custom.css" >
	<link rel="stylesheet" type="text/css" href="/static/css/jquery.json-view.min.css">


	<!-- https://jquery.com/ -->
	<script src="/static/js/jquery-1.11.2.min.js"></script>
	<script src="/static/js/jquery-migrate-1.2.1.min.js"></script>

	<!-- D3 library //cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js -->
	<script src="/static/js/d3.min.js"></script>

	<!-- http://getbootstrap.com/ -->
	<script src="/static/js/bootstrap.min.js"></script>

	<!-- http://www.jstree.com/ -->
	<script src="/static/js/jstree/jstree.min.js"></script>

	<!-- http://silviomoreto.github.io/bootstrap-select/ -->
	<script src="/static/js/bootstrap-select.min.js"></script>

	<!-- http://www.bootstrap-switch.org/ -->
	<!-- https://github.com/nostalgiaz/bootstrap-switch -->
	<script src="/static/js/bootstrap-switch.min.js"></script>

	<!-- http://bootstrap-growl.remabledesigns.com/ -->
	<!-- https://github.com/mouse0270/bootstrap-notify -->
	<script src="/static/js/bootstrap-notify.min.js"></script>

	<!-- https://github.com/carhartl/jquery-cookie -->
	<script src="/static/js/jqcookie/jquery.cookie.js"></script>

	<!-- http://www.jacklmoore.com/colorbox/ -->
	<!-- https://github.com/jackmoore/colorbox -->
	<script src="/static/js/jquery.colorbox-min.js"></script>

	<!-- https://gist.github.com/jonraasch/563055 -->
	<script src="/static/js/textsearch.js"></script>

	<!-- https://gist.github.com/jonraasch/563055 -->
	<script src="/static/js/bootstrap-table.min.js"></script>

	<!-- https://github.com/1kko/jquery.json-view -->
	<script src="/static/js/jquery.json-view.min.js"></script>

	<!-- https://github.com/gabelerner/canvg -->
	<script src="/static/js/rgbcolor.js"></script>
	<script src="/static/js/StackBlur.js"></script>
	<script src="/static/js/canvg.js"></script>

	<!-- D3 behavior pid graph -->
	<script src="/static/js/graph_behavior_pid.js"></script>

	<!-- application js -->
	<script src="/static/js/app.js"></script>
</head>

<body>
	<nav class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<!-- Brand and toggle get grouped for better mobile display -->
			<div class="navbar-header">
				<a class="navbar-brand" rel="home" href="/" title="MDPDP">
					<img src="/static/images/android-chrome-36x36.png" class="navbar-brand" style="padding:0px 0px 32px 15px;">
						DPDP <small style="font-size:7px;">designed by ikko</small>
				</a>
			</div>

			<!-- Collect the nav links, forms, and other content for toggling -->
			<ul class="nav navbar-nav">
				<li><a href="/" id="goto_enginediff_main">Dashboard</a></li>
				<li class="active"><a href="#">Analysis</a></li>
				<li><a href="/uploadcsv/" id="goto_enginediff_uploader">Upload CSV</a></li>
				<li>
					<div id="toggle_tree_chart" class="col-xs-2" style="margin-top:14px;">
						<input type="checkbox" id="tree_chart_toggle">
					</div>
				</li>
				<li>
					<div class="navbar-form pull-right">
						<input id="text-search" type="text" class="form-control" placeholder="Search" style="width:70%;" value="mdpLog.behavior.behaviorData.target.@bc_id=16781315">
						<button class="btn btn-primary" id="btn-search">Search</button>
					</div>
				</li>
			</ul>
		</div><!-- /.container-fluid -->
	</nav>

	
	<div class="container-fluid">
		<div class="show" id="left_pane">
			<div id="dragbar"></div>
			<div id="div-history">
				<div id="div-history-title">
					<h4>Query History</h4>
					<table class="table table-condensed table-striped" id="historyTable">
						<thead>
							<tr>
								<th><i class="axi axi-highlight-remove"></i></th>
								<th>AND</th>
								<th>Query</th>
								<th>Count</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
				</div>
				<h4 id="andQueryTitle">AND Query</h4>
				<div id="andQueryCount"></div>
				<div id="andQueryView"></div>
			</div>
		</div>
		<div id="editor_pane">
			<h4 id="h3_category_title"></h3>
			<div id="jsonView" class="col-xs-12"></div>
			<div id="tableView">
				<button class="btn btn-primary" id="find_common" data-toggle="modal" data-target="#myModal">Find Common</button>
				<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
					<div class="modal-dialog" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								<h4 class="modal-title" id="myModalLabel">Common Key Values</h4>
							</div>
							<div class="modal-body" id="myModalBody">
								<table id="myModalTable"
								data-striped="true"
								data-row-style="rowStyle"
								data-click-to-select="true"
								data-maintain-selected="true"
								>

									<thead>
										<tr>
											<th data-visible="true" data-checkbox="true" data-field="selection"></th>
											<th data-visible="true" data-sortable="true" data-field="key">Key</th>
											<th data-visible="true" data-sortable="true" data-field="value">Value</th>
										</tr>
									</thead>
								</table>
							</div>
							<div class="modal-footer">
								<button type="button" class="btn btn-default" data-dismiss="modal" id="btnCloseModal">Close</button>
								<button type="button" class="btn btn-primary" id="btnSave">Save changes</button>
							</div>
						</div>
					</div>
				</div>

				<table id='filelist'
				data-show-columns="true"
				data-pagination="true"
				data-side-pagination="server"
				data-page-list="[5, 10, 20, 50, 100, 200]"
				data-search="true"
				data-sort-name="REPORT_PC_COUNT"
				data-sort-order="desc"
				data-striped="true"
				data-row-style="rowStyle"
				data-page-size="50"
				data-click-to-select="true"
				data-maintain-selected="true"
				>
					<thead>
					<tr>
						<th data-visible="true"  data-checkbox="true" data-field="sel">S</th>
						<th data-sortable="true" data-visible="true"  data-field="MD5_KEY">MD5</th>
						<th data-sortable="true" data-visible="false" data-field="FILE_NAME">File Name</th>
						<th data-sortable="true" data-visible="false" data-field="RESULT_NUMBER">Result</th>
						<th data-sortable="true" data-visible="true"  data-field="VIRUS_NAME">Virus Name</th>
						<th data-sortable="true" data-visible="false" data-field="SIGN_CREDIT" data-align="right">Sign Credit</th>
						<th data-sortable="true" data-visible="true"  data-field="REPORT_PC_COUNT" data-align="right">PC Count</th>
						<th data-sortable="true" data-visible="false" data-field="SAVED_SIZE" data-align="right">File Size</th>
						<th data-sortable="true" data-visible="false" data-field="FILE_TAG">File Tag</th>
						<th data-sortable="true" data-visible="true"  data-field="CTIME" data-align="center">Collection Time</th>
					</tr>
					</thead>
				</table>
			</div>
		</div>
</body>


<script>
$(document).ready(function(){
	// $("#goto_enginediff_main").on('click', function() {
	// 	url = window.location.protocol + '//' + window.location.hostname + "/enginediff/";
	// 	console.log("redirecting to ", url);
	// 	window.location.replace(url);
	// });

	// $("#goto_enginediff_uploader").on('click', function() {
	// 	url = window.location.protocol + '//' + window.location.hostname + "/enginediff/uploader.php";
	// 	console.log("redirecting to ", url);
	// 	window.location.replace(url);
	// });


	$('#text-search').on('focusin', 
	function() {
		W=$(this).parent().parent().width();
		$(this).animate({width:W},100).css('word-break','break-all');
	}).on('focusout',
	function() {
		$(this).animate({width:'70%', height:'38px'},200);
	});

	// var i = 0;
	$('#dragbar').mousedown(function(e){
		e.preventDefault();
			// $('#mousestatus').html("mousedown" + i++);
			$(document).mousemove(function(e){
			// $('#position').html(e.pageX +', '+ e.pageY);
			$('#left_pane').css("width",e.pageX+2);
			$('#editor_pane').css("left",e.pageX+2+30);
		})
		// console.log("leaving mouseDown");
	});
	$(document).mouseup(function(e){
		// $('#clickevent').html('in another mouseUp event' + i++);
		$(document).unbind('mousemove');
	});
	$('#dragbar').trigger('mousedown').trigger('mouseup');


	// adding enter event to search input box
	$('#text-search').live('keypress', function (e) {
		if (e.which==13) { // 13 == enter key@ascii
			$('#btn-search').click();
		}
	});

	// flask if / endif
	{% if query %}
	$('#text-search').val("{{query}}");
	$('#btn-search').click();
	{% endif %}

	{% if md5list %}
	var md5list="{{md5list}}".split(";");
	for (var i in md5list) {
		$('#text-search').val("md5="+md5list[i]);
		$('#btn-search').click();
	}
	// reset searchbox.
	$('#text-search').val("");
	{% endif %}
});

</script>
<!-- 
mdpLog.behavior.behaviorData.target.@bc_id=16781315


http://localhost:28017/MDP/behaviorCollection/?filter_mdpLog.behavior.behaviorData.target.@bc_id=16781315

mdpLog.targetSample.file.md5=0d881c8d165ed96d0b929b8e7e8c0242 -->